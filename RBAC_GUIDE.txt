ğŸ—³ï¸ VOTE-AHOLIC - ROLE-BASED ACCESS CONTROL (RBAC) GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ¯ OVERVIEW

Your voting system now has TWO user roles with different permissions:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature         â”‚ ADMIN           â”‚ VOTER            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Create Election â”‚ âœ… YES          â”‚ âŒ NO            â”‚
â”‚ Add Candidates  â”‚ âœ… YES          â”‚ âŒ NO            â”‚
â”‚ Vote            â”‚ âœ… YES          â”‚ âœ… YES           â”‚
â”‚ View Results    â”‚ âœ… YES          â”‚ âœ… YES (LIVE)    â”‚
â”‚ Clear Votes     â”‚ âœ… YES          â”‚ âŒ NO            â”‚
â”‚ Manage Database â”‚ âœ… YES          â”‚ âŒ NO            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ‘¥ USER ROLES

### ğŸ”‘ ADMIN (Administrator)
â”œâ”€ Full control of the voting system
â”œâ”€ Can create elections
â”œâ”€ Can add candidates
â”œâ”€ Can clear/reset votes
â”œâ”€ Can view all voting statistics
â”œâ”€ Can manage database
â””â”€ Can view live voting results

### ğŸ—³ï¸ VOTER (Regular User)
â”œâ”€ Can view available elections
â”œâ”€ Can vote in elections (once per election)
â”œâ”€ Can view live voting results
â”œâ”€ CANNOT create elections
â”œâ”€ CANNOT clear votes
â””â”€ CANNOT manage database

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸš€ SETUP INSTRUCTIONS

### Step 1: Start the Server
```bash
npm start
```

### Step 2: Create First Admin User
Use the admin-tools command:
```bash
node admin-tools.js make-admin [username]
```

Example:
```bash
node admin-tools.js make-admin john_admin
```

### Step 3: Register Regular Users
When users register, they're automatically assigned the 'voter' role.
Only admins can perform admin operations.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ”‘ HOW TO ASSIGN ROLES

### Method 1: Command Line (Recommended)
```bash
# Make a user an admin
node admin-tools.js make-admin username

# Example:
node admin-tools.js make-admin sarah_johnson
```

### Method 2: View Current Users and Roles
```bash
node admin-tools.js view-users
```

Output shows:
```
User ID    | Username      | Email              | Role
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€
abc12345   | john_admin    | john@example.com   | admin
def67890   | sarah_voter   | sarah@example.com  | voter
ghi11111   | mike_voter    | mike@example.com   | voter
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ” AUTHENTICATION & WORKFLOW

### For Admins:
1. Register/Login as admin user
2. Admin panel automatically loads with all controls
3. Create elections and add candidates
4. Monitor voting in real-time
5. Clear votes when needed
6. Access database management tools

### For Voters:
1. Register/Login as regular user
2. See list of active elections
3. Select an election and vote
4. View live voting results
5. Cannot access admin features

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“‹ TYPICAL WORKFLOW

### Admin Setup Phase
```
1. Make yourself an admin:
   node admin-tools.js make-admin your_username

2. Login as admin
   
3. Create an election
   Title: "Board President Election 2026"
   
4. Add candidates:
   - Alice Smith (Democratic Party)
   - Bob Johnson (Republican Party)
   - Carol Williams (Independent)
   
5. Share voting link with voters
```

### Voter Phase
```
1. Voters register as regular users

2. Voters login

3. See available elections

4. Select "Board President Election 2026"

5. Vote for their candidate

6. See live results (both admin & voters see same results)
```

### Results & Cleanup Phase
```
1. Admin monitors voting in real-time

2. When voting is complete, admin can:
   - See final results
   - Clear votes for next round (if needed)
   - Archive election results
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ”’ SECURITY & PERMISSIONS

### Admin-Only Operations:

**Create Election:**
- Requires: userId (admin user)
- Returns: Error 403 if user is not admin
- Example error:
  ```
  {
    "error": "Admin access required. Only administrators can create elections."
  }
  ```

**Clear All Votes:**
- Requires: userId (admin user)
- POST /api/votes/admin/clear
- Returns: Error 403 if user is not admin

**Clear Election Votes:**
- Requires: userId (admin user)
- POST /api/votes/admin/clear/:electionId
- Returns: Error 403 if user is not admin

### Everyone Can:
- GET /api/elections (view all)
- GET /api/votes/results/:electionId (view results)
- POST /api/votes (cast vote)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ’» API ENDPOINTS WITH ROLE CHECKS

### Elections
- **GET** /api/elections â†’ Everyone (list all)
- **POST** /api/elections â†’ Admin only (create) â­
- **GET** /api/elections/:id â†’ Everyone (view one)
- **PUT** /api/elections/:id â†’ Admin only (update) â­

### Voting & Results
- **GET** /api/votes/results/:id â†’ Everyone (view results) â­
- **POST** /api/votes â†’ Everyone (cast vote)
- **GET** /api/votes â†’ Everyone (view all)
- **POST** /api/votes/admin/clear â†’ Admin only â­
- **POST** /api/votes/admin/clear/:id â†’ Admin only â­

### Users
- **GET** /api/users â†’ Everyone (list all)
- **POST** /api/users â†’ Everyone (register)
- **GET** /api/users/:id â†’ Everyone (get user info)

â­ = Protected endpoints with role-based access control

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“ EXAMPLE: COMPLETE VOTING WORKFLOW

### Step 1: Admin Setup (Admin User)
```bash
# Make admin user
node admin-tools.js make-admin alice

# Login as alice (admin)
# Create election: "CEO Election"
# Add candidates:
#   - Bob Smith (IT Department)
#   - Carol Jones (Marketing Department)
#   - Dave Williams (Finance Department)
```

### Step 2: Voter Registration & Voting (Voter Users)
```bash
# Users register as voters
# Login as voter
# See election: "CEO Election"
# Vote for preferred candidate
# See live results showing all votes
```

### Step 3: Monitoring & Results (Admin)
```bash
# Admin logs in
# Sees admin dashboard with:
#   - Total votes cast
#   - Vote count per candidate
#   - Current leader
#   - Real-time updates

# Can clear votes if needed:
node admin-tools.js clear-votes
# OR use admin panel UI
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âš ï¸ IMPORTANT NOTES

1. **New users are voters by default** - They cannot create elections or clear votes

2. **Admin actions are logged** - All admin operations should be monitored

3. **Results are visible to everyone** - Both admins and voters see the same live results

4. **Secure admin assignment** - Only assign admin role via command-line to trusted users

5. **Cannot self-demote** - Admins must use command-line to change roles

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ› ï¸ TROUBLESHOOTING

### "Admin access required" Error
â†’ The user is not an admin
â†’ Make them admin: node admin-tools.js make-admin username

### "User not found" Error
â†’ Username doesn't exist
â†’ Check spelling: node admin-tools.js view-users

### Cannot see Clear Votes button
â†’ You're not logged in as admin
â†’ Login as admin account or create admin account

### Results not updating
â†’ Check server is running: npm start
â†’ Refresh page to get latest results

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š DATABASE SCHEMA

Users table now includes role:
```sql
CREATE TABLE users (
  id TEXT PRIMARY KEY,
  username TEXT UNIQUE NOT NULL,
  email TEXT UNIQUE NOT NULL,
  password TEXT NOT NULL,
  role TEXT DEFAULT 'voter',      -- 'admin' or 'voter'
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP
)
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“ QUICK COMMANDS

```bash
# Make user admin
node admin-tools.js make-admin username

# View all users and their roles
node admin-tools.js view-users

# Clear all votes (admin only)
node admin-tools.js clear-votes

# View voting statistics
node admin-tools.js stats

# Start server
npm start

# Check election results
curl http://localhost:3001/api/votes/results/[electionId]
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… VERIFICATION

Verify role-based access is working:

1. Create admin user:
   ```bash
   node admin-tools.js make-admin test_admin
   ```

2. View users to confirm role:
   ```bash
   node admin-tools.js view-users
   ```
   Should show: `test_admin | ... | admin`

3. Login as voter and try to create election:
   ```
   Should get: "Admin access required" error
   ```

4. Login as admin and create election:
   ```
   Should succeed
   ```

5. Try clearing votes as voter:
   ```
   Should get: "Admin access required" error
   ```

6. Try clearing votes as admin:
   ```
   Should succeed
   ```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your voting system is now fully role-based! ğŸ‰

- Admins have full control
- Voters can participate securely
- Results are transparent to everyone
- Clear separation of concerns

Ready to use! ğŸ—³ï¸
